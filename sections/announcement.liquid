{% assign show_on_page = true %}
{% if
  section.settings.home-page-only and
  request.page_type != 'index' or
  request.page_type == 'password'
%}
  {% assign show_on_page = false %}
{% endif %}

<div
  class="announcement--root"
  data-section-id="{{ section.id }}"
  data-section-type="announcement"
  data-js-class="IndexAnnouncement"
>
  {% if section.settings.enabled and show_on_page %}

    {% if section.settings.link != blank %}
      <a class="announcement--link--full-width" href="{{section.settings.link}}">
    {% endif %}

    <div class="announcement--wrapper">
      {% if section.settings.icon %}
        <div class="announcement--icon">
          {{ section.settings.icon | img_url: '50x50' | img_tag: section.settings.icon.alt }}
        </div>
      {% endif %}

      {% if section.settings.text != blank %}
        <div class="announcement--text" data-item="accent-text">
          {{ section.settings.text | escape }}
        </div>
      {% endif %}
    </div>

    {% if section.settings.link != blank %}
      </a>
    {% endif %}

  {% endif %}
</div>

{% schema %}
{
  "name": "Announcement",
  "settings": [
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Show announcement",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "home-page-only",
      "label": "Home page only",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "icon",
      "label": "Icon image",
      "info": "50 x 50px recommended"
    },
    {
      "type": "text",
      "id": "text",
      "label": "Text",
      "default": "Annoucement for sales, promos, shipping info & more â€” Click and Collect available"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link"
    }
  ]
}
{% endschema %}